#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è¤‡é›‘ãªå ´æ‰€æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ€çµ‚ãƒ†ã‚¹ãƒˆ
"""

import sys
import os
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'src'))

from reminder_flex_customizer import ReminderFlexCustomizer

def test_complex_location_patterns():
    """è¤‡é›‘ãªå ´æ‰€æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ€çµ‚ãƒ†ã‚¹ãƒˆ"""
    print("=" * 80)
    print("ğŸ¯ è¤‡é›‘ãªå ´æ‰€æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ€çµ‚ãƒ†ã‚¹ãƒˆ")
    print("=" * 80)

    customizer = ReminderFlexCustomizer()

    # ã‚ˆã‚Šè¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
    complex_cases = [
        {
            "name": "è¤‡æ•°ã®è¿½åŠ æƒ…å ±ãŒã‚ã‚‹ã‚±ãƒ¼ã‚¹",
            "content": """åœ°åŸŸå¤§ä¼š
å ´æ‰€ï¼šè‘›é£¾åŒºæŸ´åˆçƒå ´ç¬¬ä¸€ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã€é›¨å¤©æ™‚ã¯ç¬¬äºŒã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã€é§è»Šå ´åˆ©ç”¨å¯ã€å£²åº—ã‚ã‚Š
æ™‚é–“ï¼šåˆå‰9æ™‚é–‹å§‹
å‚åŠ è²»ï¼š1000å††
é€£çµ¡å…ˆï¼šäº‹å‹™å±€""",
            "expected": "è‘›é£¾åŒºæŸ´åˆçƒå ´ç¬¬ä¸€ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰"
        },
        {
            "name": "æ±äº¬ãƒ‰ãƒ¼ãƒ  with è©³ç´°æƒ…å ±",
            "content": """éƒ½å¸‚å¯¾æŠ—é‡çƒ
æ±äº¬ãƒ‰ãƒ¼ãƒ ã«ã¦é–‹å‚¬äºˆå®šã€ãƒã‚±ãƒƒãƒˆã¯å½“æ—¥è²©å£²
æ—¥æ™‚ï¼š7æœˆ15æ—¥åˆå¾Œ6æ™‚é–‹å§‹
å…¥å ´æ–™ï¼šä¸€èˆ¬2000å††ã€å­¦ç”Ÿ1000å††""",
            "expected": "æ±äº¬ãƒ‰ãƒ¼ãƒ "
        },
        {
            "name": "ç¥å®®çƒå ´ã§ã®é–‹å‚¬",
            "content": """ãƒ—ãƒ­é‡çƒè¦³æˆ¦
æ˜æ²»ç¥å®®é‡çƒå ´ã§è¦³æˆ¦ã—ã¾ã™
é›†åˆï¼šåˆå¾Œ1æ™‚æ­£é¢å…¥å£
è²»ç”¨ï¼š3500å††ï¼ˆãƒã‚±ãƒƒãƒˆä»£è¾¼ã¿ï¼‰""",
            "expected": "æ˜æ²»ç¥å®®é‡çƒå ´"
        },
        {
            "name": "æ‹¬å¼§å†…ã«ä½æ‰€æƒ…å ±",
            "content": """ç§‹å­£ãƒªãƒ¼ã‚°æˆ¦
ä¼šå ´ï¼šå“å·åŒºæ°‘çƒå ´ï¼ˆå“å·åŒºæ±äº”åç”°2-2-2ã€å¤§å´é§…å¾’æ­©10åˆ†ï¼‰
é–‹å§‹ï¼šåˆå‰10æ™‚
æŒå‚ï¼šãƒ¦ãƒ‹ãƒ•ã‚©ãƒ¼ãƒ ä¸€å¼""",
            "expected": "å“å·åŒºæ°‘çƒå ´"
        },
        {
            "name": "è¤‡æ•°æ–½è¨­ãŒæ··åœ¨",
            "content": """åˆå®¿ã®ãŠçŸ¥ã‚‰ã›
å®¿æ³Šï¼šè»½äº•æ²¢ãƒ›ãƒ†ãƒ«
ç·´ç¿’å ´æ‰€ï¼šè»½äº•æ²¢ç·åˆé‹å‹•å ´é‡çƒå ´
é£Ÿäº‹ï¼šãƒ›ãƒ†ãƒ«å†…ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³
æœŸé–“ï¼š3æ³Š4æ—¥""",
            "expected": "è»½äº•æ²¢ç·åˆé‹å‹•å ´é‡çƒå ´"
        },
        {
            "name": "ã€Œã«ã¦é–‹å‚¬ã€ãƒ‘ã‚¿ãƒ¼ãƒ³",
            "content": """è¦ªå–„è©¦åˆ
é§’æ²¢ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯å…¬åœ’é‡çƒå ´ã«ã¦é–‹å‚¬
å‚åŠ ãƒãƒ¼ãƒ ï¼š8ãƒãƒ¼ãƒ 
å„ªå‹è³å“ï¼šãƒˆãƒ­ãƒ•ã‚£ãƒ¼""",
            "expected": "é§’æ²¢ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯å…¬åœ’é‡çƒå ´"
        }
    ]

    for i, test_case in enumerate(complex_cases, 1):
        print(f"\nğŸ§ª è¤‡é›‘ãƒ†ã‚¹ãƒˆ {i}: {test_case['name']}")
        print("-" * 60)

        # å ´æ‰€æƒ…å ±æŠ½å‡º
        extracted_location = customizer._extract_location_info(test_case["content"])

        print(f"ğŸ“ å…¥åŠ›å†…å®¹ï¼ˆ1è¡Œç›®ã®ã¿ï¼‰: {test_case['content'].split(chr(10))[0]}...")
        print(f"ğŸ¯ æœŸå¾…å€¤: {test_case['expected']}")
        print(f"ğŸ“¤ æŠ½å‡ºçµæœ: {extracted_location}")

        # åˆ¤å®š
        if extracted_location == test_case['expected']:
            print("âœ… å®Œå…¨ä¸€è‡´")
        else:
            print("âŒ ä¸ä¸€è‡´")
            # éƒ¨åˆ†ä¸€è‡´ã‚‚ãƒã‚§ãƒƒã‚¯
            if extracted_location and test_case['expected'] in extracted_location:
                print(f"   âš ï¸ éƒ¨åˆ†ä¸€è‡´ï¼ˆä½™åˆ†ãªæƒ…å ±: '{extracted_location.replace(test_case['expected'], '').strip()}'ï¼‰")

    print("\n" + "=" * 80)
    print("ğŸ‰ è¤‡é›‘ãªå ´æ‰€æƒ…å ±ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆå®Œäº†")
    print("=" * 80)

if __name__ == "__main__":
    test_complex_location_patterns()
